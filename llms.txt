# quallmer

The **quallmer** package is an **easy-to-use toolbox to quickly apply
AI-assisted qualitative coding to large amounts of texts, images, pdfs,
tabular data and other structured data.**

Using
[`qlm_code()`](https://seraphinem.github.io/quallmer/reference/qlm_code.md),
users can apply codebook-based qualitative coding powered by large
language models (LLMs) to generate structured, interpretable outputs.
The package includes built-in codebooks for common applications and
allows researchers to create custom codebooks tailored to their specific
research questions using
[`qlm_codebook()`](https://seraphinem.github.io/quallmer/reference/qlm_codebook.md).
To ensure quality and reliability of AI-generated coding, **quallmer**
provides
[`qlm_compare()`](https://seraphinem.github.io/quallmer/reference/qlm_compare.md)
for evaluating inter-rater reliability and
[`qlm_validate()`](https://seraphinem.github.io/quallmer/reference/qlm_validate.md)
for assessing accuracy against gold standards. With
[`qlm_replicate()`](https://seraphinem.github.io/quallmer/reference/qlm_replicate.md),
researchers can systematically compare results across different models
and settings to assess sensitivity and reproducibility. The quallmer
trail system automatically captures provenance metadata for full
workflow traceability using
[`qlm_trail()`](https://seraphinem.github.io/quallmer/reference/qlm_trail.md)
and related functions.

**The quallmer package makes AI-assisted qualitative coding accessible
without requiring deep expertise in R, programming or machine
learning.**

## Coding and validation workflow

#### `qlm_codebook()`

- Creates custom codebooks tailored to specific research questions and
  data types.
- Uses `instructions` and type specifications from
  [ellmer](https://ellmer.tidyverse.org/reference/type_boolean.html) to
  define coding instructions and output structure.
- Example codebook objects (e.g., `data_codebook_sentiment`,
  `data_codebook_stance`, `data_codebook_ideology`) demonstrate how to
  use built-in codebooks for common qualitative coding tasks.
- Extensible framework allows researchers to define domain-specific
  coding schemes.

#### `qlm_code()`

- Applies LLM-based coding to qualitative data using a `qlm_codebook`.
- Works with any LLM supported by
  [ellmer](https://ellmer.tidyverse.org/index.html).
- Returns a `qlm_coded` object containing the coded results and metadata
  for reproducibility.

#### `qlm_compare()`

- Compares multiple `qlm_coded` objects to assess inter-rater
  reliability.
- Computes agreement metrics including Krippendorff’s alpha, Cohen’s
  kappa, and Fleiss’ kappa.
- Useful for evaluating consistency across different coders, models, or
  coding runs.

#### `qlm_validate()`

- Validates LLM-coded output against gold standard human coding.
- Computes classification metrics: accuracy, precision, recall,
  F1-score, and Cohen’s kappa.
- Supports multiple averaging methods (macro, micro, weighted) and
  per-class breakdowns.

## Replication

#### `qlm_replicate()`

- Re-executes coding with optional overrides (different models,
  codebooks, or parameters).
- Tracks provenance chain for comparing results across different
  configurations.
- Enables systematic assessment of coding reliability and sensitivity to
  model choices.

## The quallmer trail

All `qlm_coded`, `qlm_comparison`, and `qlm_validation` objects
automatically capture provenance metadata including model parameters,
timestamps, and parent-child relationships. This enables full workflow
traceability. It also allows users to assess the impact of different
models and settings on coding results as well as on downstream analyses.

#### `qlm_trail()`

- Extracts and displays the complete provenance chain from coded
  objects.
- Shows the history of coding runs including model parameters,
  timestamps, and parent relationships.
- Reconstructs full lineage by following parent-child references across
  multiple objects.
- Automatically captures branching workflows when multiple coded objects
  are compared or validated.

#### `qlm_trail_save()`, `qlm_trail_export()`, `qlm_trail_report()`

- **Save**: Archive provenance trails to RDS format for long-term
  storage.
- **Export**: Convert trails to JSON format for portability and
  integration with other tools.
- **Report**: Generate human-readable Quarto/RMarkdown documents
  summarizing the complete workflow history, including an assessment of
  the impact of different models and settings on coding results and
  downstream analyses.

## Interactive validation

For an interactive Shiny application to perform manual coding, review
AI-generated annotations, and compute agreement metrics, see the
companion package
[quallmer.app](https://github.com/SeraphineM/quallmer.app).

## Supported LLMs

The package supports all LLMs currently available with the `ellmer`
package. For authentication and usage of each of these LLMs, please
refer to the respective
[ellmer](https://ellmer.tidyverse.org/reference/index.html)
documentation and see our [tutorial for setting up an OpenAI API
key](https://seraphinem.github.io/quallmer/articles/pkgdown/tutorials/openai.html)
or [getting started with an open-source Ollama
model](https://seraphinem.github.io/quallmer/articles/pkgdown/tutorials/ollama.html).

## Installation

You can install the development version of **quallmer** from
<https://github.com/SeraphineM/quallmer> with:

``` r
# install.packages("pak")
pak::pak("SeraphineM/quallmer")
```

## Example use and tutorials

To learn more about how to use the package, please refer to our
[step-by-step
tutorials](https://seraphinem.github.io/quallmer/articles/getting-started.html).

## Acknowledgments

Development of this package was assisted by [Claude
Code](https://claude.com/claude-code), an AI coding assistant by
Anthropic, for code refactoring, documentation updates, and package
restructuring.

# Package index

## All functions

- [`data_codebook_fact`](https://seraphinem.github.io/quallmer/reference/data_codebook_fact.md)
  : Fact-checking codebook
- [`data_codebook_ideology`](https://seraphinem.github.io/quallmer/reference/data_codebook_ideology.md)
  : Ideological scaling codebook for left-right dimension
- [`data_codebook_salience`](https://seraphinem.github.io/quallmer/reference/data_codebook_salience.md)
  : Topic salience codebook
- [`data_codebook_sentiment`](https://seraphinem.github.io/quallmer/reference/data_codebook_sentiment.md)
  : Sentiment analysis codebook for movie reviews
- [`data_codebook_stance`](https://seraphinem.github.io/quallmer/reference/data_codebook_stance.md)
  : Stance detection codebook for climate change
- [`data_corpus_LMRDsample`](https://seraphinem.github.io/quallmer/reference/data_corpus_LMRDsample.md)
  : Sample from Large Movie Review Dataset (Maas et al. 2011)
- [`data_corpus_manifsentsUK2010sample`](https://seraphinem.github.io/quallmer/reference/data_corpus_manifsentsUK2010sample.md)
  : Sample of UK manifesto sentences 2010 crowd-annotated for
  immigration
- [`qlm_code()`](https://seraphinem.github.io/quallmer/reference/qlm_code.md)
  : Code qualitative data with an LLM
- [`qlm_codebook()`](https://seraphinem.github.io/quallmer/reference/qlm_codebook.md)
  : Define a qualitative codebook
- [`qlm_compare()`](https://seraphinem.github.io/quallmer/reference/qlm_compare.md)
  : Compare coded results for inter-rater reliability
- [`qlm_humancoded()`](https://seraphinem.github.io/quallmer/reference/qlm_humancoded.md)
  : Convert human-coded data to qlm_coded format
- [`qlm_replicate()`](https://seraphinem.github.io/quallmer/reference/qlm_replicate.md)
  : Replicate a coding task
- [`qlm_trail()`](https://seraphinem.github.io/quallmer/reference/qlm_trail.md)
  : Extract provenance trail from quallmer objects
- [`qlm_trail_export()`](https://seraphinem.github.io/quallmer/reference/qlm_trail_export.md)
  : Export trail to JSON
- [`qlm_trail_report()`](https://seraphinem.github.io/quallmer/reference/qlm_trail_report.md)
  : Generate trail report
- [`qlm_trail_robustness()`](https://seraphinem.github.io/quallmer/reference/qlm_trail_robustness.md)
  : Compute robustness scale showing downstream analysis changes
- [`qlm_trail_save()`](https://seraphinem.github.io/quallmer/reference/qlm_trail_save.md)
  : Save trail to RDS file
- [`qlm_validate()`](https://seraphinem.github.io/quallmer/reference/qlm_validate.md)
  : Validate coded results against a gold standard

# Articles

### All vignettes

- [Comparing and replicating coded
  results](https://seraphinem.github.io/quallmer/articles/pkgdown/tutorials/compare.md):
- [Creating
  codebooks](https://seraphinem.github.io/quallmer/articles/pkgdown/tutorials/custom-codebook.md):
- [Example: Sentiment
  analysis](https://seraphinem.github.io/quallmer/articles/pkgdown/examples/example_sentiment.md):
- [Getting started with
  quallmer](https://seraphinem.github.io/quallmer/articles/getting-started.md):
- [Working with an open-source Ollama
  model](https://seraphinem.github.io/quallmer/articles/pkgdown/tutorials/ollama.md):
- [Signing up for an openai API
  key](https://seraphinem.github.io/quallmer/articles/pkgdown/tutorials/openai.md):
- [The quallmer
  trail](https://seraphinem.github.io/quallmer/articles/pkgdown/tutorials/trail.md):
- [Using the quallmer
  app](https://seraphinem.github.io/quallmer/articles/pkgdown/tutorials/validate.md):
