<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example: Salience of topics • quallmer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../../../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../../../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../../../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../../../favicon.ico">
<link rel="manifest" href="../../../site.webmanifest">
<script src="../../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../../deps/search-1.0.0/fuse.min.js"></script><script src="../../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../../pkgdown.js"></script><meta property="og:title" content="Example: Salience of topics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../../index.html">quallmer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../../../articles/getting-started.html">Quick start guide</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/tutorials/openai.html">Signing up for an openai API key</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/tutorials/ollama.html">Working with an open-source Ollama model</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/tutorials/predefined.html">Using predefined tasks</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/tutorials/customtask.html">Defining custom tasks</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/tutorials/agreement.html">Using the Agreement App</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/tutorials/trail.html">The quallmer trail</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-predefined-tasks" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Predefined tasks</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-predefined-tasks">
<li><a class="dropdown-item" href="../../../articles/pkgdown/examples/overview.html">Overview of predefined tasks</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/examples/task_sentiment.html">Sentiment analysis</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/examples/task_stance.html">Stance detection / position taking</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/examples/task_ideology.html">Ideological scaling</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/examples/task_salience.html">Salience of topics</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/examples/task_fact.html">Fact-checking</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../../../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SeraphineM/quallmer" aria-label="View on GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="task_salience_files/kePrint-0.0.1/kePrint.js"></script><link href="task_salience_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../../logo.png" class="logo" alt=""><h1>Example: Salience of topics</h1>
            
      

      <div class="d-none name"><code>task_salience.Rmd</code></div>
    </div>

    
    
<p>The <code><a href="../../../reference/annotate.html">annotate()</a></code> function with a predefined
<code><a href="../../../reference/task_salience.html">task_salience()</a></code> can be used to identify and rank the
salience of topics discussed in texts. In this example, we will
demonstrate how to apply this task to a sample corpus of innaugural
speeches from US presidents.</p>
<div class="section level3">
<h3 id="loading-packages-and-data">Loading packages and data<a class="anchor" aria-label="anchor" href="#loading-packages-and-data"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We will use the quanteda package </span></span>
<span><span class="co"># for loading a sample corpus of innaugural speeches</span></span>
<span><span class="co"># If you have not yet installed the quanteda package, you can do so by:</span></span>
<span><span class="co"># install.packages("quanteda")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://quanteda.io" class="external-link">quanteda</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Package version: 4.3.1</span></span>
<span><span class="co">## Unicode version: 15.1</span></span>
<span><span class="co">## ICU version: 74.2</span></span></code></pre>
<pre><code><span><span class="co">## Parallel computing: disabled</span></span></code></pre>
<pre><code><span><span class="co">## See https://quanteda.io for tutorials and examples.</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://SeraphineM.github.io/quallmer" class="external-link">quallmer</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: ellmer</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For educational purposes, </span></span>
<span><span class="co"># we will use a subset of the inaugural speeches corpus</span></span>
<span><span class="co"># The three most recent speeches in the corpus</span></span>
<span><span class="va">data_corpus_inaugural</span> <span class="op">&lt;-</span> <span class="fu">quanteda</span><span class="fu">::</span><span class="va"><a href="https://quanteda.io/reference/data_corpus_inaugural.html" class="external-link">data_corpus_inaugural</a></span><span class="op">[</span><span class="fl">57</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-annotate-for-salience-of-any-topics-discussed-in-texts">Using <code>annotate()</code> for salience of ANY topics discussed
in texts<a class="anchor" aria-label="anchor" href="#using-annotate-for-salience-of-any-topics-discussed-in-texts"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply predefined salience task with task_salience() in the annotate() function</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/annotate.html">annotate</a></span><span class="op">(</span><span class="va">data_corpus_inaugural</span>, task <span class="op">=</span> <span class="fu"><a href="../../../reference/task_salience.html">task_salience</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                   chat_fn <span class="op">=</span> <span class="va">chat_openai</span>, model <span class="op">=</span> <span class="st">"gpt-4o"</span>,</span>
<span>                   api_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>temperature <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Running task 'Salience (ranked topics)' using model: gpt-4o</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 3 -&gt; 1 | <span style="color: #00BB00;">■■■■■■■■■                       </span>  25%</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 2 -&gt; 2 | <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50%</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 0 -&gt; 4 | <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100%</span></span></code></pre>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:left;">
topics
</th>
<th style="text-align:left;">
explanation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
2013-Obama
</td>
<td style="text-align:left;">
American Values and Ideals , Equality and Civil Rights , Collective
Action and Unity , Economic and Social Progress, Role of Government
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li><p><strong>American Values and Ideals</strong>: The speech
frequently references foundational American principles such as liberty,
democracy, and the Constitution, emphasizing their enduring
importance.</p></li>
<li><p><strong>Equality and Civil Rights</strong>: There is a strong
focus on equality, with references to historical movements and the
ongoing journey towards equal rights for all citizens, including women
and LGBTQ+ individuals.</p></li>
<li><p><strong>Collective Action and Unity</strong>: The text emphasizes
the need for unity and collective action to address modern challenges,
highlighting the importance of working together as a nation.</p></li>
<li><p><strong>Economic and Social Progress</strong>: The speech
discusses economic recovery, the importance of a strong middle class,
and the need for social programs like Medicare and Social
Security.</p></li>
<li>
<p><strong>Role of Government</strong>: There is a discussion on the
role of government in ensuring fair play in the market, protecting
citizens, and adapting to new challenges, balancing individual freedoms
with collective needs.</p>
</li>
</ol>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>2017-Trump</p>
</td>
<td style="text-align:left;">
<p>Transfer of Power to the People , America First Policy , National
Unity and Patriotism , Economic Rebuilding and Job Creation, Critique of
Political Establishment</p>
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>
<strong>Transfer of Power to the People</strong>: The speech
emphasizes returning power from Washington to the citizens, highlighting
this as a central theme.</li>
</ol>
<li><p><strong>America First Policy</strong>: The repeated focus on
prioritizing American interests in trade, immigration, and foreign
policy underscores its importance.</p></li>
<li><p><strong>National Unity and Patriotism</strong>: The call for
unity and patriotism is a recurring theme, with references to shared
values and protection.</p></li>
<li><p><strong>Economic Rebuilding and Job Creation</strong>: There is
significant emphasis on rebuilding infrastructure and creating jobs,
reflecting its salience.</p></li>
<li>
<p><strong>Critique of Political Establishment</strong>: The speech
critiques the political establishment for failing the people, making it
a notable topic.</p>
</li>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>2021-Biden</p>
</td>
<td style="text-align:left;">
<p>Unity , Democracy , Challenges facing America , American values and
ideals , Historical context and legacy</p>
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>
<strong>Unity</strong>: The speech emphasizes unity as a central
theme, repeatedly calling for Americans to come together to face
challenges and heal divisions.</li>
</ol>
<li><p><strong>Democracy</strong>: Democracy is highlighted as a
precious and fragile cause that has prevailed, with references to the
peaceful transfer of power and the will of the people.</p></li>
<li><p><strong>Challenges facing America</strong>: The text discusses
various challenges such as the pandemic, racial justice, political
extremism, and climate change, emphasizing the need to address them
collectively.</p></li>
<li><p><strong>American values and ideals</strong>: The speech
frequently references values like liberty, dignity, and truth, framing
them as core to the American identity and future.</p></li>
<li>
<p><strong>Historical context and legacy</strong>: The speech
situates current events within a historical narrative, referencing past
struggles and achievements to inspire action and continuity.</p>
</li>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>2025-Trump</p>
</td>
<td style="text-align:left;">
<p>American Renewal and Greatness , Government Reform and Efficiency ,
National Security and Immigration , Economic Policies and Energy
Independence, Unity and National Pride</p>
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>
<strong>American Renewal and Greatness</strong>: The speech
emphasizes a new era for America, focusing on national success,
prosperity, and reclaiming greatness. Phrases like “golden age of
America” and “make America great again” highlight this theme.</li>
</ol>
<li><p><strong>Government Reform and Efficiency</strong>: There is
significant focus on reforming government structures, ending corruption,
and restoring trust. The mention of a new Department of Government
Efficiency and ending government censorship underscores this.</p></li>
<li><p><strong>National Security and Immigration</strong>: The speech
discusses securing borders, ending illegal immigration, and designating
cartels as terrorist organizations, indicating a strong emphasis on
national security.</p></li>
<li><p><strong>Economic Policies and Energy Independence</strong>:
Economic revitalization through energy independence, manufacturing, and
trade reforms is a key topic, with specific plans like “drill, baby,
drill” and ending the Green New Deal.</p></li>
<li>
<p><strong>Unity and National Pride</strong>: The speech frequently
mentions national unity, pride, and the collective American spirit,
aiming to inspire and unify the nation across various demographics.</p>
</li>
</td>
</tr>
</tbody>
</table>
<h3 id="using-annotate-for-salience-of-any-topics-discussed-in-texts-1">Using
<code>annotate()</code> for salience of a SPECIFIED LIST of topics
discussed in texts<a class="anchor" aria-label="anchor" href="#using-annotate-for-salience-of-any-topics-discussed-in-texts-1"></a>
</h3>

<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a list of topics to focus on</span></span>
<span><span class="va">topics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"economy"</span>, <span class="st">"health"</span>, <span class="st">"education"</span>, <span class="st">"environment"</span>, <span class="st">"foreign policy"</span><span class="op">)</span></span>
<span><span class="co"># Apply predefined salience task with task_salience() in the annotate() function</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/annotate.html">annotate</a></span><span class="op">(</span><span class="va">data_corpus_inaugural</span>, task <span class="op">=</span> <span class="fu"><a href="../../../reference/task_salience.html">task_salience</a></span><span class="op">(</span><span class="va">topics</span><span class="op">)</span>, </span>
<span>                   chat_fn <span class="op">=</span> <span class="va">chat_openai</span>, model <span class="op">=</span> <span class="st">"gpt-4o"</span>,</span>
<span>                   api_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>temperature <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Running task 'Salience (ranked topics)' using model: gpt-4o</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 3 -&gt; 1 | <span style="color: #00BB00;">■■■■■■■■■                       </span>  25%</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 2 -&gt; 2 | <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50%</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 0 -&gt; 4 | <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100%</span></span></code></pre>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:left;">
topics
</th>
<th style="text-align:left;">
explanation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
2013-Obama
</td>
<td style="text-align:left;">
economy , environment , foreign policy, education , health
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li><p><strong>Economy</strong>: The text frequently discusses economic
themes, such as economic recovery, prosperity, and the importance of a
rising middle class. It emphasizes the need for infrastructure, fair
markets, and economic vitality.</p></li>
<li><p><strong>Environment</strong>: There is a clear emphasis on
climate change and sustainable energy, highlighting the need to lead in
this transition and preserve natural resources.</p></li>
<li><p><strong>Foreign Policy</strong>: The text addresses America’s
role in global peace, alliances, and supporting democracy worldwide,
emphasizing engagement and diplomacy.</p></li>
<li><p><strong>Education</strong>: The need for education reform and
training in math and science is mentioned as essential for future
economic success.</p></li>
<li>
<p><strong>Health</strong>: Health care is mentioned in the context
of reducing costs and ensuring security and dignity for citizens,
alongside programs like Medicare and Medicaid.</p>
</li>
</ol>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>2017-Trump</p>
</td>
<td style="text-align:left;">
<p>economy , foreign policy, education , health , environment</p>
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>
<strong>Economy</strong>: The text frequently discusses economic
issues such as jobs, factories, wealth distribution, and infrastructure,
emphasizing the need to rebuild the economy and prioritize American
workers.</li>
</ol>
<li><p><strong>Foreign Policy</strong>: There is significant emphasis on
foreign policy, particularly regarding trade, military spending, and
alliances, with a focus on ‘America first’ and protecting American
interests.</p></li>
<li><p><strong>Education</strong>: The speech mentions the education
system, highlighting issues with its current state and the need for
improvement.</p></li>
<li><p><strong>Health</strong>: Health is indirectly referenced through
mentions of poverty and the need to address societal issues, though not
as prominently as other topics.</p></li>
<li>
<p><strong>Environment</strong>: The environment is not directly
addressed, but there are references to infrastructure and industry,
which can have environmental implications.</p>
</li>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>2021-Biden</p>
</td>
<td style="text-align:left;">
<p>health , economy , environment , foreign policy</p>
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>
<strong>Health</strong>: The text emphasizes the impact of the
pandemic, mentioning the virus as a significant challenge, the loss of
lives, and the need to face the pandemic as a nation.</li>
</ol>
<li><p><strong>Economy</strong>: There is mention of job losses,
business closures, and the need to rebuild the middle class, indicating
economic concerns.</p></li>
<li><p><strong>Environment</strong>: The text refers to a ‘cry for
survival from the planet,’ highlighting environmental issues.</p></li>
<li>
<p><strong>Foreign Policy</strong>: The text discusses America’s
role in the world, repairing alliances, and engaging globally, which
relates to foreign policy.</p>
</li>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>2025-Trump</p>
</td>
<td style="text-align:left;">
<p>foreign policy, economy , health , environment , education</p>
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal">
<li>
<strong>Foreign Policy</strong>: The text frequently discusses
international relations, border security, and actions against foreign
entities, emphasizing a strong stance on sovereignty and international
respect.</li>
</ol>
<li><p><strong>Economy</strong>: Economic issues are highlighted through
mentions of inflation, energy policies, manufacturing, and trade
reforms, indicating a focus on economic revitalization.</p></li>
<li><p><strong>Health</strong>: The speech references the public health
system and promises to address health crises, including a mention of the
COVID vaccine mandate.</p></li>
<li><p><strong>Environment</strong>: Environmental policies are
addressed with the mention of ending the Green New Deal and energy
independence, showing a focus on traditional energy sources.</p></li>
<li>
<p><strong>Education</strong>: The education system is criticized
for its current state, with promises of reform, indicating its
importance in the agenda.</p>
</li>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="adjusting-the-task_salience-so-it-also-returns-the-stance-for-each-topic">Adjusting the task_salience() so it also returns the stance for each
topic<a class="anchor" aria-label="anchor" href="#adjusting-the-task_salience-so-it-also-returns-the-stance-for-each-topic"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Customizing the task to include the stance for each topic</span></span>
<span><span class="va">custom_task</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/task.html">task</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Salience and stance of topics"</span>,</span>
<span>  system_prompt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>    <span class="st">"You are an expert analysing the content of texts."</span>,</span>
<span>    <span class="st">""</span>,</span>
<span>    <span class="st">"Task:"</span>,</span>
<span>    <span class="st">"- Read the text carefully."</span>,</span>
<span>    <span class="st">"- Identify and rank the salience of the following topics: economy, health, education, environment, foreign policy."</span>,</span>
<span>    <span class="st">"- For each topic mentioned, assign a stance as one of the following:"</span>,</span>
<span>    <span class="st">"  pro, neutral, or contra."</span>,</span>
<span>    <span class="st">"- Append the stance directly after each topic name in the form 'topic: stance'."</span>,</span>
<span>    <span class="st">"- Return all topic:stance entries in descending order of salience."</span>,</span>
<span>    <span class="st">"- Separate entries with commas when presenting them in a list."</span>,</span>
<span>    <span class="st">""</span>,</span>
<span>    <span class="st">"Do not infer information that is not in the text."</span>,</span>
<span>    <span class="st">"Base all evaluations solely on the language and arguments in the document."</span>,</span>
<span>    <span class="st">""</span>,</span>
<span>    <span class="st">"Output:"</span>,</span>
<span>    <span class="st">"- `topic_stance`: a ranked list of topic labels with stance labels appended (e.g., 'economy: pro', 'health: contra')."</span>,</span>
<span>    <span class="st">"- `explanation`: a brief justification explaining why the topics were ordered and how stance was determined."</span>,</span>
<span>    sep <span class="op">=</span> <span class="st">"\n"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  type_def <span class="op">=</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_object</a></span><span class="op">(</span></span>
<span>    topic_stance <span class="op">=</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_array</a></span><span class="op">(</span></span>
<span>      <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_string</a></span><span class="op">(</span><span class="st">"Topic and stance label combined (e.g., 'economy: pro'), ranked by salience."</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    explanation <span class="op">=</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_string</a></span><span class="op">(</span></span>
<span>      <span class="st">"Brief justification for the salience ordering and stance classification."</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  input_type <span class="op">=</span> <span class="st">"text"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply the customized task in the annotate() function</span></span>
<span><span class="va">custom_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/annotate.html">annotate</a></span><span class="op">(</span><span class="va">data_corpus_inaugural</span>, task <span class="op">=</span> <span class="va">custom_task</span>, </span>
<span>                   chat_fn <span class="op">=</span> <span class="va">chat_openai</span>, model <span class="op">=</span> <span class="st">"gpt-4o"</span>,</span>
<span>                   api_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>temperature <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Running task 'Salience and stance of topics' using model: gpt-4o</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 3 -&gt; 1 | <span style="color: #00BB00;">■■■■■■■■■                       </span>  25%</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 2 -&gt; 2 | <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50%</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 0 -&gt; 4 | <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100%</span></span></code></pre>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:left;">
topic_stance
</th>
<th style="text-align:left;">
explanation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
2013-Obama
</td>
<td style="text-align:left;">
economy: pro , environment: pro , foreign policy: pro, health: pro ,
education: pro
</td>
<td style="text-align:left;">
The text emphasizes the importance of a strong economy, highlighting the
need for infrastructure, fair competition, and a rising middle class,
indicating a pro stance on the economy. The environment is addressed
with a commitment to tackling climate change and leading in sustainable
energy, showing a pro stance. Foreign policy is discussed in terms of
maintaining alliances and promoting peace, indicating a pro stance.
Health is mentioned in the context of reducing healthcare costs and
supporting social safety nets like Medicare, showing a pro stance.
Education is highlighted as essential for future prosperity, with a
focus on reforming schools and training workers, indicating a pro
stance. The salience order reflects the depth and frequency of
discussion on each topic.
</td>
</tr>
<tr>
<td style="text-align:left;">
2017-Trump
</td>
<td style="text-align:left;">
economy: pro , foreign policy: neutral, education: contra , environment:
neutral , health: neutral
</td>
<td style="text-align:left;">
The text primarily focuses on economic issues, emphasizing job creation,
infrastructure development, and protectionist policies, indicating a pro
stance on the economy. Foreign policy is addressed with a focus on
‘America first’ and alliances, suggesting a neutral stance as it
balances protectionism with international cooperation. Education is
mentioned negatively, highlighting a failing system, which suggests a
contra stance. The environment is not directly addressed, but
infrastructure plans imply a neutral stance. Health is briefly mentioned
in the context of eradicating disease, suggesting a neutral stance.
</td>
</tr>
<tr>
<td style="text-align:left;">
2021-Biden
</td>
<td style="text-align:left;">
democracy: pro , health: pro , unity: pro , foreign policy: pro,
environment: pro , economy: pro
</td>
<td style="text-align:left;">
The speech primarily focuses on the theme of democracy, emphasizing its
triumph and the need to protect it, making ‘democracy: pro’ the most
salient topic. Health is addressed through the discussion of the
pandemic and the need to overcome it, leading to ‘health: pro’. Unity is
a central theme, repeatedly mentioned as essential for progress, hence
‘unity: pro’. Foreign policy is touched upon with a commitment to
re-engage with the world, resulting in ‘foreign policy: pro’. The
environment is mentioned in the context of a ‘cry for survival from the
planet’, leading to ‘environment: pro’. Economic issues are addressed
through references to job losses and rebuilding the middle class,
resulting in ‘economy: pro’.
</td>
</tr>
<tr>
<td style="text-align:left;">
2025-Trump
</td>
<td style="text-align:left;">
foreign policy: pro, economy: pro , environment: contra, health: contra
, education: contra
</td>
<td style="text-align:left;">
The speech emphasizes foreign policy with a strong stance on border
security, military strength, and international respect, making it the
most salient topic. The economy is also prominent, with plans to reduce
inflation, increase manufacturing, and use natural resources, indicating
a pro stance. The environment is addressed negatively, with plans to end
the Green New Deal and promote drilling, leading to a contra stance.
Health is mentioned in the context of a failing public health system and
reversing COVID vaccine mandates, suggesting a contra stance. Education
is criticized for promoting negative views of the country, resulting in
a contra stance.
</td>
</tr>
</tbody>
</table>
<p>In this example, we demonstrated how to use the
<code><a href="../../../reference/task_salience.html">task_salience()</a></code> for identifying and ranking topics
discussed in texts, both with and without a predefined list of topics.
Additionally, we showed how to customize the task to include stance
classification for each topic. This showcases the flexibility of the
<code><a href="../../../reference/annotate.html">annotate()</a></code> function and the <code>task</code> framework in
<code>quallmer</code> for various text analysis tasks.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Seraphine F. Maerz, Kenneth Benoit.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
