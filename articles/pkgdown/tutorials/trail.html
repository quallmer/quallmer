<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The quallmer trail • quallmer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../../../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../../../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../../../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../../../favicon.ico">
<link rel="manifest" href="../../../site.webmanifest">
<script src="../../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../../deps/search-1.0.0/fuse.min.js"></script><script src="../../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../../pkgdown.js"></script><meta property="og:title" content="The quallmer trail">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../../index.html">quallmer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../../../articles/getting-started.html">Quick start guide</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/tutorials/openai.html">Signing up for an openai API key</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/tutorials/ollama.html">Working with an open-source Ollama model</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/tutorials/predefined.html">Using predefined tasks</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/tutorials/customtask.html">Defining custom tasks</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/tutorials/validate.html">Using the Agreement App</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/tutorials/trail.html">The quallmer trail</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-predefined-tasks" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Predefined tasks</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-predefined-tasks">
<li><a class="dropdown-item" href="../../../articles/pkgdown/examples/overview.html">Overview of predefined tasks</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/examples/task_sentiment.html">Sentiment analysis</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/examples/task_stance.html">Stance detection / position taking</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/examples/task_ideology.html">Ideological scaling</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/examples/task_salience.html">Salience of topics</a></li>
    <li><a class="dropdown-item" href="../../../articles/pkgdown/examples/task_fact.html">Fact-checking</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../../../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SeraphineM/quallmer" aria-label="View on GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="trail_files/kePrint-0.0.1/kePrint.js"></script><link href="trail_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../../logo.png" class="logo" alt=""><h1>The quallmer trail</h1>
            
      

      <div class="d-none name"><code>trail.Rmd</code></div>
    </div>

    
    
<p>In this tutorial, we will walk through the <code>quallmer</code>
trail functionality step-by-step. The trail functions allow users to
systematically compare LLM-generated annotations across multiple runs
with different settings, ensuring reproducibility and reliability of the
results.</p>
<div class="section level2">
<h2 id="loading-packages-and-data-and-defining-a-task">Loading packages and data and defining a task<a class="anchor" aria-label="anchor" href="#loading-packages-and-data-and-defining-a-task"></a>
</h2>
<p>We will start by loading the necessary packages and a sample dataset.
We will then define a custom task that we want the LLMs to perform.</p>
<div class="section level3">
<h3 id="loading-packages-and-data">Loading packages and data<a class="anchor" aria-label="anchor" href="#loading-packages-and-data"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We will use the quanteda package </span></span>
<span><span class="co"># for loading a sample corpus of innaugural speeches</span></span>
<span><span class="co"># If you have not yet installed the quanteda package, you can do so by:</span></span>
<span><span class="co"># install.packages("quanteda")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://quanteda.io" class="external-link">quanteda</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Package version: 4.3.1</span></span>
<span><span class="co">## Unicode version: 15.1</span></span>
<span><span class="co">## ICU version: 74.2</span></span></code></pre>
<pre><code><span><span class="co">## Parallel computing: disabled</span></span></code></pre>
<pre><code><span><span class="co">## See https://quanteda.io for tutorials and examples.</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://seraphinem.github.io/quallmer/">quallmer</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: ellmer</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For educational purposes, </span></span>
<span><span class="co"># we will use a subset of the inaugural speeches corpus</span></span>
<span><span class="co"># The three most recent speeches in the corpus</span></span>
<span><span class="va">data_corpus_inaugural</span> <span class="op">&lt;-</span> <span class="fu">quanteda</span><span class="fu">::</span><span class="va"><a href="https://quanteda.io/reference/data_corpus_inaugural.html" class="external-link">data_corpus_inaugural</a></span><span class="op">[</span><span class="fl">57</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span></span>
<span><span class="co"># turn corpus into data frame</span></span>
<span><span class="va">data_corpus_inaugural</span> <span class="op">&lt;-</span> <span class="fu">quanteda</span><span class="fu">::</span><span class="fu"><a href="https://quanteda.io/reference/convert.html" class="external-link">convert</a></span><span class="op">(</span><span class="va">data_corpus_inaugural</span>, to <span class="op">=</span> <span class="st">"data.frame"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="defining-a-custom-prompt">Defining a custom prompt<a class="anchor" aria-label="anchor" href="#defining-a-custom-prompt"></a>
</h3>
<p>This is very similar to defining a custom prompt for the
<code><a href="../../../reference/annotate.html">annotate()</a></code> function. Here, we define a prompt that
instructs the LLM to score documents based on their alignment with the
political left.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prompt</span> <span class="op">&lt;-</span> <span class="st">"Score the following document on a scale of how much it aligns</span></span>
<span><span class="st">with the political left. The political left is defined as groups which</span></span>
<span><span class="st">advocate for social equality, government intervention in the economy,</span></span>
<span><span class="st">and progressive policies. Use the following metrics:</span></span>
<span><span class="st">SCORING METRIC:</span></span>
<span><span class="st">3 : extremely left</span></span>
<span><span class="st">2 : very left</span></span>
<span><span class="st">1 : slightly left</span></span>
<span><span class="st">0 : not at all left"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="defining-the-structure-of-the-response-with-define_task">Defining the structure of the response with define_task()<a class="anchor" aria-label="anchor" href="#defining-the-structure-of-the-response-with-define_task"></a>
</h3>
<p>The <code><a href="../../../reference/task.html">task()</a></code> function allows us to specify the expected
structure of the LLM’s response. It has the following important
arguments which users need to specify:</p>
<ul>
<li>
<code>name</code>: A descriptive name for the task.</li>
<li>
<code>system_prompt</code>: The prompt that guides the LLM on how to
perform the task.</li>
<li>
<code>type_def</code>: Defines the expected structure of the
response using <a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">ellmer’s
type specifications</a> such as <code><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_object()</a></code>,
<code><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_array()</a></code>, etc.</li>
</ul>
<p>For more information on how to use ellmer’s type specifications,
please refer to the <a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">ellmer
documentation on type specifications</a>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the custom task using task()</span></span>
<span><span class="va">ideology_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/task.html">task</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Score Political Left Alignment"</span>,</span>
<span>  system_prompt <span class="op">=</span> <span class="va">prompt</span>,</span>
<span>  type_def <span class="op">=</span> <span class="fu"><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_object</a></span><span class="op">(</span></span>
<span>    score <span class="op">=</span> <span class="fu"><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_number</a></span><span class="op">(</span><span class="st">"Score"</span><span class="op">)</span>,</span>
<span>    explanation <span class="op">=</span> <span class="fu"><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_string</a></span><span class="op">(</span><span class="st">"Explanation"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  input_type <span class="op">=</span> <span class="st">"text"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="define-different-trail-settings">Define different trail settings<a class="anchor" aria-label="anchor" href="#define-different-trail-settings"></a>
</h2>
<p>After having defined our task, we can now set up different trail
settings to compare how different LLM configurations affect the results.
For this, we can use the <code><a href="../../../reference/trail_settings.html">trail_settings()</a></code> function. In this
example, we will create four settings with different models and
different temperature values to see how they affect the LLM’s
responses.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">setting_gptmini0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/trail_settings.html">trail_settings</a></span><span class="op">(</span></span>
<span>provider <span class="op">=</span> <span class="st">"openai"</span>,</span>
<span>model <span class="op">=</span> <span class="st">"gpt-4o-mini"</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">setting_gptmini7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/trail_settings.html">trail_settings</a></span><span class="op">(</span></span>
<span>provider <span class="op">=</span> <span class="st">"openai"</span>,</span>
<span>model <span class="op">=</span> <span class="st">"gpt-4o-mini"</span>,</span>
<span>temperature <span class="op">=</span> <span class="fl">0.7</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">setting_gpt400</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/trail_settings.html">trail_settings</a></span><span class="op">(</span></span>
<span>provider <span class="op">=</span> <span class="st">"openai"</span>,</span>
<span>model <span class="op">=</span> <span class="st">"gpt-4o"</span>,</span>
<span>temperature <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">setting_gpt407</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/trail_settings.html">trail_settings</a></span><span class="op">(</span></span>
<span>provider <span class="op">=</span> <span class="st">"openai"</span>,</span>
<span>model <span class="op">=</span> <span class="st">"gpt-4o"</span>,</span>
<span>temperature <span class="op">=</span> <span class="fl">0.7</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="record-a-single-trail-with-a-specific-setting">Record a single trail with a specific setting<a class="anchor" aria-label="anchor" href="#record-a-single-trail-with-a-specific-setting"></a>
</h2>
<p>We can use the <code><a href="../../../reference/trail_record.html">trail_record()</a></code> function to record a
single trail with a specific setting. This is useful for ensuring
reproducibility of results with a given configuration. The example below
shows how to record metadata for a trail using the
<code>setting_T0</code> defined earlier. The result of this function is
a data frame containing the LLM-generated annotations for each document
in the dataset as well as the associated metadata such as the setting
used, the task, the data, timestamp, etc. You can save this output for
future reference to ensure that you can reproduce the results later. You
can also share this output with others to allow them to verify your
findings.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rec_T0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/trail_record.html">trail_record</a></span><span class="op">(</span></span>
<span>data <span class="op">=</span> <span class="va">data_corpus_inaugural</span>,</span>
<span>text_col <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>task <span class="op">=</span> <span class="va">ideology_scores</span>,</span>
<span>setting <span class="op">=</span> <span class="va">setting_gptmini0</span>,</span>
<span>id_col <span class="op">=</span> <span class="st">"doc_id"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 3 -&gt; 1 | <span style="color: #00BB00;">■■■■■■■■■                       </span>  25%</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 0 -&gt; 4 | <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100%</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the recorded trail's settings</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'kableExtra'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     group_rows</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meta_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  field <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rec_T0</span><span class="op">$</span><span class="va">meta</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">rec_T0</span><span class="op">$</span><span class="va">meta</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># pretty-print lists</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">x</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"&lt;br&gt;"</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">x</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span>, FUN.VALUE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">meta_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="st">"html"</span>, escape <span class="op">=</span> <span class="cn">FALSE</span>, col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Field"</span>, <span class="st">"Value"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span>, full_width <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/column_spec.html" class="external-link">column_spec</a></span><span class="op">(</span><span class="fl">1</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-striped table-hover" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Field
</th>
<th style="text-align:left;">
Value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
timestamp
</td>
<td style="text-align:left;">
2025-12-16 04:56:35.617204
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
n_rows
</td>
<td style="text-align:left;">
4
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
provider
</td>
<td style="text-align:left;">
openai
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
model
</td>
<td style="text-align:left;">
gpt-4o-mini
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
temperature
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
api_extra
</td>
<td style="text-align:left;">
list()
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
cache_dir
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
cache_path
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
id_col
</td>
<td style="text-align:left;">
doc_id
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
text_col
</td>
<td style="text-align:left;">
text
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
task_class
</td>
<td style="text-align:left;">
task
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
quallmer_ver
</td>
<td style="text-align:left;">
0.1.1
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
ellmer_ver
</td>
<td style="text-align:left;">
0.4.0
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
R_ver
</td>
<td style="text-align:left;">
4.5.2
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="run-multiple-trails-with-different-settings">Run multiple trails with different settings<a class="anchor" aria-label="anchor" href="#run-multiple-trails-with-different-settings"></a>
</h2>
<p>This step involves running the same task and data across multiple
settings using the <code><a href="../../../reference/trail_compare.html">trail_compare()</a></code> function. This allows us
to see how different configurations impact the LLM’s outputs.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">left_trails</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/trail_compare.html">trail_compare</a></span><span class="op">(</span></span>
<span>data <span class="op">=</span> <span class="va">data_corpus_inaugural</span>,</span>
<span>text_col <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>task <span class="op">=</span> <span class="va">ideology_scores</span>,</span>
<span>settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  T0 <span class="op">=</span> <span class="va">setting_gptmini0</span>,</span>
<span>  T07 <span class="op">=</span> <span class="va">setting_gptmini7</span>,</span>
<span>  T40 <span class="op">=</span> <span class="va">setting_gpt400</span>,</span>
<span>  T407 <span class="op">=</span> <span class="va">setting_gpt407</span></span>
<span><span class="op">)</span>,</span>
<span>id_col <span class="op">=</span> <span class="st">"doc_id"</span>,</span>
<span>label_col <span class="op">=</span> <span class="st">"score"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 3 -&gt; 1 | <span style="color: #00BB00;">■■■■■■■■■                       </span>  25%</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 1 -&gt; 3 | <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■         </span>  75%</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 0 -&gt; 4 | <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100%</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 3 -&gt; 1 | <span style="color: #00BB00;">■■■■■■■■■                       </span>  25%</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 0 -&gt; 4 | <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100%</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 3 -&gt; 1 | <span style="color: #00BB00;">■■■■■■■■■                       </span>  25%</span></span></code></pre>
<pre><code><span><span class="co">## [working] (0 + 0) -&gt; 0 -&gt; 4 | <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100%</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the annotation matrix</span></span>
<span><span class="va">left_trails</span><span class="op">$</span><span class="va">matrix</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">##   doc_id        T0   T07   T40  T407</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 2013-Obama     2     2     2     2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2017-Trump     0     0     0     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 2021-Biden     2     2     2     2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 2025-Trump     0     0     0     0</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the intercoder reliability results</span></span>
<span><span class="va">left_trails</span><span class="op">$</span><span class="va">icr</span></span></code></pre></div>
<pre><code><span><span class="co">## $units_included</span></span>
<span><span class="co">## [1] 4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $coders</span></span>
<span><span class="co">## [1] 4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $categories</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $percent_unanimous_units</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $mean_pairwise_percent_agreement</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $mean_pairwise_cohens_kappa</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $kripp_alpha_nominal</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $fleiss_kappa</span></span>
<span><span class="co">## [1] 1</span></span></code></pre>
<p>The output above shows the annotation matrix where each row
corresponds to a document and each column corresponds to a different
trail setting. The values in the matrix represent the scores assigned by
the LLM under each configuration. This allows us to see how consistent
the LLM’s annotations are across different settings.</p>
<p>The intercoder reliability results provide a quantitative measure of
agreement between the different trail settings. Higher values indicate
greater consistency in the LLM’s annotations across configurations.</p>
<p>Overall, the trail functionality in the <code>quallmer</code> package
provides a systematic way to assess the reproducibility and reliability
of LLM-generated annotations by <strong>recording metadata for single
LLM runs and and comparing results across multiple runs with different
configurations.</strong> This is particularly useful for researchers who
want to ensure that their findings are robust and not overly dependent
on specific LLM settings. It also helps with the decision of which model
and settings to use for a given annotation task.</p>
<p>Still to come: We plan to add a function that generates sensitivity
ranges — effectively mapping how much key settings can vary while still
producing stable downstream results, and identifying when those results
begin to shift. <strong>Stay tuned for updates!</strong></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Seraphine F. Maerz, Kenneth Benoit.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
