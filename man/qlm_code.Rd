% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/qlm_code.R
\name{qlm_code}
\alias{qlm_code}
\title{Code qualitative data with an LLM}
\usage{
qlm_code(x, codebook, model, ...)
}
\arguments{
\item{x}{Input data: a character vector of texts (for text codebooks) or
file paths to images (for image codebooks). Named vectors will use names
as identifiers in the output; unnamed vectors will use sequential integers.}

\item{codebook}{A codebook object created with \code{\link[=qlm_codebook]{qlm_codebook()}} or one of
the predefined codebook functions (\code{\link[=task_sentiment]{task_sentiment()}}, \code{\link[=task_stance]{task_stance()}},
\code{\link[=task_ideology]{task_ideology()}}, \code{\link[=task_salience]{task_salience()}}, \code{\link[=task_fact]{task_fact()}}). Also accepts
deprecated \code{\link[=task]{task()}} objects for backward compatibility.}

\item{model}{Provider (and optionally model) name in the form
\code{"provider/model"} or \code{"provider"} (which will use the default model for
that provider). Passed to the \code{name} argument of \code{\link[ellmer:chat-any]{ellmer::chat()}}.
Examples: \code{"openai/gpt-4o-mini"}, \code{"anthropic/claude-3-5-sonnet-20241022"},
\code{"ollama/llama3.2"}, \code{"openai"} (uses default OpenAI model).}

\item{...}{Additional arguments passed to either \code{\link[ellmer:chat-any]{ellmer::chat()}} or to
\code{\link[ellmer:parallel_chat]{ellmer::parallel_chat_structured()}}, based on argument name.
Arguments not recognized by either function will generate a warning.}
}
\value{
A \code{qlm_coded} object (a tibble with additional attributes):
\describe{
\item{Data columns}{The coded results with a \code{.id} column for identifiers.}
\item{Attributes}{\code{codebook}, \code{data}, \code{chat_args}, \code{pcs_args}, and \code{metadata}.}
}
The object prints as a tibble and can be used directly in data manipulation workflows.
}
\description{
Applies a codebook to input data using a large language model, returning
a rich object that includes the codebook, execution settings, results, and
metadata for reproducibility.
}
\details{
Arguments in \code{...} are dynamically routed to either \code{\link[ellmer:chat-any]{ellmer::chat()}} or to
\code{\link[ellmer:parallel_chat]{ellmer::parallel_chat_structured()}} based on their names.

Progress indicators and error handling are provided by the underlying
\code{\link[ellmer:parallel_chat]{ellmer::parallel_chat_structured()}} function. Set \code{verbose = TRUE} to see
progress messages during batch coding. Retry logic for API failures
should be configured through ellmer's options.
}
\examples{
\dontrun{
# Basic sentiment analysis
texts <- c("I love this product!", "This is terrible.")
coded <- qlm_code(texts, task_sentiment(), model = "openai")
coded  # Print results as tibble

# With named inputs (names become IDs in output)
texts <- c(doc1 = "Great service!", doc2 = "Very disappointing.")
coded <- qlm_code(texts, task_sentiment(), model = "openai")

# Specify provider and model
coded <- qlm_code(texts, task_sentiment(), model = "openai/gpt-4o-mini")

# With execution control
coded <- qlm_code(texts, task_sentiment(),
                  model = "openai/gpt-4o-mini",
                  max_active = 5)

# Include token usage
coded <- qlm_code(texts, task_sentiment(),
                  model = "openai",
                  include_tokens = TRUE)

# Inspect metadata
print(coded)
attr(coded, "chat_args")
attr(coded, "metadata")
}

}
\seealso{
\code{\link[=qlm_codebook]{qlm_codebook()}} for creating codebooks,
\code{\link[=task_sentiment]{task_sentiment()}}, \code{\link[=task_stance]{task_stance()}}, \code{\link[=task_ideology]{task_ideology()}}, \code{\link[=task_salience]{task_salience()}},
\code{\link[=task_fact]{task_fact()}} for predefined codebooks, \code{\link[=annotate]{annotate()}} for the deprecated function.
}
